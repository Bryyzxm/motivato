<!DOCTYPE html>
<html
  lang="en"
  class="scroll-smooth"
>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />

    <!-- Tambahkan ini untuk memastikan dark mode berfungsi -->
    <script>
      // On page load or when changing themes, best to add inline in `head` to avoid FOUC
      if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    </script>

    <!-- google fonts -->
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;900&display=swap"
      rel="stylesheet"
    />

    <link
      href="./output.css"
      rel="stylesheet"
    />

    <!-- feather icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    <title>Motivato</title>

    <!-- Flatpickr CSS and JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  </head>
  <body class="bg-white dark:bg-gray-900 font-poppins transition-all duration-200">
    <nav class="bg-white border-gray-200 dark:bg-gray-900 relative drop-shadow-sm dark:lg:drop-shadow-lg">
      <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
        <a
          href="#"
          class="flex items-center space-x-3 rtl:space-x-reverse"
        >
          <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Motivato</span>
        </a>
        <div class="relative flex items-center md:order-2 space-x-1 md:space-x-0 rtl:space-x-reverse">
          <!-- Language Selector Button -->
          <div class="relative inline-block text-left">
            <button
              id="language-selector"
              type="button"
              class="inline-flex items-center font-medium justify-center px-4 py-2 text-sm text-gray-900 dark:text-white rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 dark:hover:text-white"
            >
              <!-- Default Flag (Indonesia) -->
              <svg
                id="selected-lang-icon"
                class="w-5 h-5 rounded-full me-3"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 512 512"
              >
                <path
                  fill="#fff"
                  d="M0 0h512v512H0z"
                />
                <path
                  fill="#f00"
                  d="M0 0h512v256H0z"
                />
              </svg>
              <span id="selected-lang-text">Bahasa Indonesia</span>
            </button>

            <!-- Language Dropdown -->
            <div
              id="language-menu"
              class="hidden absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-lg shadow-md dark:bg-gray-800 dark:border-gray-700 z-50"
              style="pointer-events: auto"
            >
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <button
                    type="button"
                    class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 dark:hover:text-white"
                    data-lang="id"
                  >
                    <div class="inline-flex items-center">
                      <svg
                        class="h-3.5 w-3.5 rounded-full me-2"
                        aria-hidden="true"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                      >
                        <path
                          fill="#fff"
                          d="M0 0h512v512H0z"
                        />
                        <path
                          fill="#f00"
                          d="M0 0h512v256H0z"
                        />
                      </svg>
                      Bahasa Indonesia
                    </div>
                  </button>
                </li>
                <li>
                  <button
                    type="button"
                    class="w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 dark:hover:text-white"
                    data-lang="en"
                  >
                    <div class="inline-flex items-center">
                      <svg
                        aria-hidden="true"
                        class="h-3.5 w-3.5 rounded-full me-2"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                      >
                        <g fill-rule="evenodd">
                          <g stroke-width="1pt">
                            <path
                              fill="#bd3d44"
                              d="M0 0h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0z"
                              transform="scale(3.9385)"
                            />
                            <path
                              fill="#fff"
                              d="M0 10h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0z"
                              transform="scale(3.9385)"
                            />
                          </g>
                          <path
                            fill="#192f5d"
                            d="M0 0h98.8v70H0z"
                            transform="scale(3.9385)"
                          />
                          <path
                            fill="#fff"
                            d="M8.2 3l1 2.8H12L9.7 7.5l.9 2.7-2.4-1.7L6 10.2l.9-2.7-2.4-1.7h3zm16.5 0l.9 2.8h2.9l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.5 0l.9 2.8H45l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.4 0l1 2.8h2.8l-2.3 1.7.9 2.7-2.4-1.7-2.3 1.7.9-2.7-2.4-1.7h3zm16.5 0l.9 2.8h2.9l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.5 0l.9 2.8h2.9l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.4 0l1 2.8H86l-2.3 1.7.9 2.7-2.4-1.7-2.3 1.7.9-2.7-2.4-1.7h3z"
                            transform="scale(3.9385)"
                          />
                        </g>
                      </svg>
                      English (US)
                    </div>
                  </button>
                </li>
              </ul>
            </div>
          </div>
          <button
            id="hamburger-menu"
            data-collapse-toggle="navbar-language"
            type="button"
            class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
            aria-controls="navbar-language"
            aria-expanded="false"
          >
            <span class="sr-only">Open main menu</span>
            <svg
              class="w-5 h-5"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 17 14"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M1 1h15M1 7h15M1 13h15"
              />
            </svg>
          </button>
        </div>
        <div
          class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1"
          id="navbar-language"
        >
          <ul
            class="flex flex-col font-medium p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:space-x-2 rtl:space-x-reverse md:flex-row md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700"
          >
            <li>
              <a
                href="#"
                class="block py-2 px-3 text-white bg-primary rounded-sm md:bg-transparent md:text-primary md:dark:text-primary"
                aria-current="page"
                >Beranda</a
              >
            </li>
            <li>
              <a
                href="#"
                class="block py-2 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
                >Komunitas</a
              >
            </li>
            <li>
              <a
                href="#"
                class="block py-2 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
                >Notifikasi</a
              >
            </li>

            <li class="flex items-center space-x-2">
              <!-- Dark Mode Toggle Button -->
              <button
                id="theme-toggle"
                type="button"
                class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5"
              >
                <svg
                  id="theme-toggle-dark-icon"
                  class="hidden w-5 h-5"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/svg"
                >
                  <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                </svg>
                <svg
                  id="theme-toggle-light-icon"
                  class="hidden w-5 h-5"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/svg"
                >
                  <path
                    d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 0 0 8 0zm-.464 4.95l.707.707a1 1 0 0 1-1.414-1.414l-.707-.707a1 1 0 0 0-1.414 1.414zm2.12-10.607a1 1 0 0 1 0 1.414l-.706.707a1 1 0 1 1-1.414-1.414l.707-.707a1 1 0 0 1 1.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                  ></path>
                </svg>
              </button>

              <!-- Instagram Link Button -->
              <a
                href="https://www.instagram.com/bryan.developer"
                target="_blank"
                rel="noopener noreferrer"
                class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5 inline-flex items-center justify-center"
              >
                <svg
                  class="w-5 h-5 text-gray-800 dark:text-white"
                  aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  fill="none"
                  viewBox="0 0 24 24"
                >
                  <path
                    fill="currentColor"
                    fill-rule="evenodd"
                    d="M3 8a5 5 0 0 1 5-5h8a5 5 0 0 1 5 5v8a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5V8Zm5-3a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V8a3 3 0 0 0-3-3H8Zm7.597 2.214a1 1 0 0 1 1-1h.01a1 1 0 1 1 0 2h-.01a1 1 0 0 1-1-1ZM12 9a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm-5 3a5 5 0 1 1 10 0 5 5 0 0 1-10 0Z"
                    clip-rule="evenodd"
                  />
                </svg>
                <span class="sr-only">Instagram</span>
              </a>

              <!-- tiktok -->
              <a
                href="https://www.tiktok.com/@bryan.developer"
                target="_blank"
                rel="noopener noreferrer"
                class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5 inline-flex items-center justify-center"
              >
                <svg
                  class="w-5 h-5 text-gray-800 dark:text-white fill-current"
                  height="512pt"
                  viewBox="-32 0 512 512"
                  width="512pt"
                  xmlns="http://www.w3.org/2000/svg"
                  id="fi_1946552"
                >
                  <path
                    d="m432.734375 112.464844c-53.742187 0-97.464844-43.722656-97.464844-97.464844 0-8.285156-6.71875-15-15-15h-80.335937c-8.285156 0-15 6.714844-15 15v329.367188c0 31.59375-25.703125 57.296874-57.300782 57.296874-31.59375 0-57.296874-25.703124-57.296874-57.296874 0-31.597657 25.703124-57.300782 122.632812-136.824219v50.8125c-41.015624 7.132812-72.296874 42.984375-72.296874 86.011719 0 48.136718 39.160156 87.300781 87.296874 87.300781 48.140626 0 87.300782-39.164063 87.300782-87.300781v-314.367188h51.210937c6.871094 58.320312 53.269531 104.71875 111.589844 111.589844zm0 0"
                  ></path>
                </svg>
                <span class="sr-only">Tiktok</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- habit tracker -->
    <section class="py-16 bg-tertiary dark:bg-gray-800">
      <div class="max-w-screen-xl mx-auto px-4">
        <div class="mb-12 text-center">
          <h2 class="text-3xl font-bold text-dark dark:text-white mb-4">Habit Tracker</h2>
          <p class="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">Pantau dan kembangkan kebiasaan baik Anda setiap hari. Visualisasi progres dengan diagram dan kalender interaktif.</p>
        </div>

        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 gap-6">
          <!-- Habit List -->
          <div class="bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md md:col-span-5">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-semibold text-dark dark:text-white">Daftar Kebiasaan</h3>
              <button
                id="tambah-kebiasaan-btn"
                class="bg-primary hover:bg-blue-600 text-white px-3 py-1 rounded-md flex items-center text-sm"
              >
                <svg
                  class="w-4 h-4 mr-1"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                  ></path>
                </svg>
                Tambah
              </button>
            </div>

            <div
              class="space-y-3"
              id="habit-list-container"
            >
              <!-- Habit Items akan ditampilkan di sini -->
            </div>
          </div>

          <!-- Chart Row: Bar Chart & Pie Chart -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Progress Diagram (Bar Chart) -->
            <div class="bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md max-w-2xl w-full mx-auto">
              <h3 class="text-xl font-semibold text-dark dark:text-white mb-4">Progres Mingguan</h3>
              <div class="flex items-center justify-between mb-4">
                <select class="bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-md px-3 py-1">
                  <option>7 Hari Terakhir</option>
                  <option>30 Hari Terakhir</option>
                  <option>3 Bulan Terakhir</option>
                </select>
                <button class="text-primary dark:text-blue-400 font-medium flex items-center">
                  <svg
                    class="w-4 h-4 mr-1"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"
                    ></path>
                  </svg>
                  Ekspor Data
                </button>
              </div>

              <div class="relative h-64">
                <!-- Grid lines container -->
                <div class="absolute inset-0 flex flex-col justify-between px-10 py-6 pointer-events-none">
                  <div class="w-full border-t border-gray-200 dark:border-gray-700">
                    <span class="absolute -left-3 -mt-2.5 text-xs text-gray-500 dark:text-gray-400">100%</span>
                  </div>
                  <div class="w-full border-t border-gray-200 dark:border-gray-700">
                    <span class="absolute -left-3 -mt-2.5 text-xs text-gray-500 dark:text-gray-400">75%</span>
                  </div>
                  <div class="w-full border-t border-gray-200 dark:border-gray-700">
                    <span class="absolute -left-3 -mt-2.5 text-xs text-gray-500 dark:text-gray-400">50%</span>
                  </div>
                  <div class="w-full border-t border-gray-200 dark:border-gray-700">
                    <span class="absolute -left-3 -mt-2.5 text-xs text-gray-500 dark:text-gray-400">25%</span>
                  </div>
                  <div class="w-full border-t border-gray-200 dark:border-gray-700">
                    <span class="absolute -left-3 -mt-2.5 text-xs text-gray-500 dark:text-gray-400">0%</span>
                  </div>
                </div>
                <!-- Chart bars container -->
                <div class="absolute inset-0 px-12 py-6">
                  <div
                    id="chart-bars"
                    class="relative w-full h-full flex gap-x-1 sm:gap-x-2 justify-between items-end"
                  ></div>
                </div>
              </div>
            </div>
            <!-- Pie Chart -->
            <div class="bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md max-w-xl w-full mx-auto flex flex-col justify-center">
              <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700 md:col-span-1">
                <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Kebiasaan Terselesaikan</h4>
                <div class="flex items-center justify-center">
                  <!-- Mockup Circle Chart -->
                  <div class="relative h-32 w-32">
                    <svg
                      viewBox="0 0 36 36"
                      class="w-full h-full"
                    >
                      <path
                        class="stroke-current text-gray-200 dark:text-gray-700"
                        stroke-width="3.8"
                        fill="none"
                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                      />
                      <path
                        class="stroke-current text-primary"
                        stroke-width="3.8"
                        stroke-linecap="round"
                        fill="none"
                        stroke-dasharray="60, 100"
                        d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                      />
                      <text
                        x="18"
                        y="20.5"
                        text-anchor="middle"
                        class="text-xs font-semibold fill-current text-gray-800 dark:text-white"
                      ></text>
                    </svg>
                  </div>
                </div>
              </div>

              <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700 mt-6 md:mt-0 md:col-span-2">
                <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Waktu Fokus Mingguan</h4>
                <div class="flex items-center justify-between flex-wrap">
                  <div class="w-full md:w-auto mb-3 md:mb-0">
                    <div class="text-2xl font-bold text-gray-800 dark:text-white">12.5 jam</div>
                    <div class="text-sm text-gray-500 dark:text-gray-400">dari target 20 jam</div>
                  </div>
                  <div class="w-full md:w-1/2 bg-gray-200 dark:bg-gray-700 rounded-full h-4">
                    <div
                      class="bg-primary h-4 rounded-full"
                      style="width: 62.5%"
                    ></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

       
        

        

    <footer class="bg-white rounded-lg shadow-lg m-4 dark:bg-gray-800">
      <div class="w-full mx-auto max-w-screen-xl p-4 md:flex md:items-center md:justify-between">
        <span class="text-sm text-gray-500 sm:text-center dark:text-gray-400"
          >© 2025
          <a
            href="https://flowbite.com/"
            class="hover:underline"
            >Motivato™</a
          >. All Rights Reserved.
        </span>
        <ul class="flex flex-wrap items-center mt-3 text-sm font-medium text-gray-500 dark:text-gray-400 sm:mt-0">
          <li>
            <a
              href="#about"
              class="hover:underline me-4 md:me-6"
              >About</a
            >
          </li>

          <li>
            <a
              href="#"
              class="hover:underline me-4 md:me-6"
              >Komunitas</a
            >
          </li>
          <li>
            <a
              href="#"
              class="hover:underline"
              >Notifikasi</a
            >
          </li>
        </ul>
      </div>
    </footer>

    <script>
      const hambugerMenu = document.getElementById('hamburger-menu');
      const menu = document.getElementById('navbar-language');

      hambugerMenu.addEventListener('click', function () {
        event.stopPropagation();
        menu.classList.toggle('hidden');
      });

      document.addEventListener('click', function () {
        if (!hambugerMenu.contains(event.target) && !menu.contains(event.target)) {
          menu.classList.add('hidden');
        }
      });
    </script>

    <script>
      // Simple language selector implementation
      document.addEventListener('DOMContentLoaded', function () {
        const selector = document.getElementById('language-selector');
        const menu = document.getElementById('language-menu');
        const displayText = document.getElementById('selected-lang-text');
        const displayIcon = document.getElementById('selected-lang-icon');
        const options = document.querySelectorAll('#language-menu button');

        // Initialize with saved preference or default
        const savedLang = localStorage.getItem('site-language') || 'id';
        setLanguageDisplay(savedLang);

        function setLanguageDisplay(lang) {
          if (lang === 'en') {
            displayText.textContent = 'English (US)';
            displayIcon.innerHTML = `<g fill-rule="evenodd"><g stroke-width="1pt"><path fill="#bd3d44" d="M0 0h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0z" transform="scale(3.9385)"/><path fill="#fff" d="M0 10h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0zm0 20h247v10H0z" transform="scale(3.9385)"/></g><path fill="#192f5d" d="M0 0h98.8v70H0z" transform="scale(3.9385)"/><path fill="#fff" d="M8.2 3l1 2.8H12L9.7 7.5l.9 2.7-2.4-1.7L6 10.2l.9-2.7-2.4-1.7h3zm16.5 0l.9 2.8h2.9l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.5 0l.9 2.8H45l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.4 0l1 2.8h2.8l-2.3 1.7.9 2.7-2.4-1.7-2.3 1.7.9-2.7-2.4-1.7h3zm16.5 0l.9 2.8h2.9l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.5 0l.9 2.8h2.9l-2.4 1.7 1 2.7-2.4-1.7-2.4 1.7 1-2.7-2.4-1.7h2.9zm16.4 0l1 2.8H86l-2.3 1.7.9 2.7-2.4-1.7-2.3 1.7.9-2.7-2.4-1.7h3z" transform="scale(3.9385)"/></g>`;
          } else {
            displayText.textContent = 'Bahasa Indonesia';
            displayIcon.innerHTML = `<path fill="#fff" d="M0 0h512v512H0z"/><path fill="#f00" d="M0 0h512v256H0z"/>`;
          }
        }

        // Toggle menu on button click
        selector.addEventListener('click', function (e) {
          e.stopPropagation();
          menu.classList.toggle('hidden');
        });

        // Close when clicking elsewhere
        document.addEventListener('click', function (e) {
          if (!selector.contains(e.target) && !menu.contains(e.target)) {
            menu.classList.add('hidden');
          }
        });

        // Handle language selection
        options.forEach((option) => {
          option.addEventListener('click', function () {
            const lang = this.getAttribute('data-lang');
            localStorage.setItem('site-language', lang);
            setLanguageDisplay(lang);
            menu.classList.add('hidden');
          });
        });
      });
    </script>

    <script>
      const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
      const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

      // Change the icons inside the button based on previous settings
      if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        themeToggleLightIcon.classList.remove('hidden');
      } else {
        themeToggleDarkIcon.classList.remove('hidden');
      }

      const themeToggleBtn = document.getElementById('theme-toggle');

      themeToggleBtn.addEventListener('click', function () {
        // toggle icons inside button
        themeToggleDarkIcon.classList.toggle('hidden');
        themeToggleLightIcon.classList.toggle('hidden');

        // if set via local storage previously
        if (localStorage.getItem('color-theme')) {
          if (localStorage.getItem('color-theme') === 'light') {
            document.documentElement.classList.add('dark');
            localStorage.setItem('color-theme', 'dark');
          } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('color-theme', 'light');
          }
        } else {
          // if NOT set via local storage previously
          if (document.documentElement.classList.contains('dark')) {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('color-theme', 'light');
          } else {
            document.documentElement.classList.add('dark');
            localStorage.setItem('color-theme', 'dark');
          }
        }

        
      });
    </script>

    <!-- Core JS -->
    <script>
      

      // Fungsi untuk menyimpan data
      function saveHabitData() {
        localStorage.setItem('habitData', JSON.stringify(habitData));
        renderAll();
      }

      // Fungsi untuk memuat data
      function loadHabitData() {
        const saved = localStorage.getItem('habitData');
        habitData = saved ? JSON.parse(saved) : { habits: [] };
        habitData.habits = habitData.habits.map(normalizeHabit);
      }

      // Fungsi untuk membuat habit baru
      function createHabit(name, color, selectedDays, reminderTime) {
        habitData.habits.push(normalizeHabit({
          id: Date.now(),
          name,
          color,
          selectedDays,
          days: Array(selectedDays.length).fill(false),
          targetDays: selectedDays.length,
          completedDays: 0,
          reminderTime: reminderTime || '',
        }));
        saveHabitData();
      }

      // Fungsi untuk memperbarui habit
      function updateHabit(id, { name, color, selectedDays, reminderTime }) {
        const h = habitData.habits.find(h => h.id === id);
        if (!h) return;
        h.name = name;
        h.color = color;
        h.selectedDays = selectedDays;
        h.targetDays = selectedDays.length;
        h.reminderTime = reminderTime;
        if (!h.days || h.days.length !== selectedDays.length) {
          h.days = Array(selectedDays.length).fill(false);
          h.completedDays = 0;
        }
        saveHabitData();
      }

      // Fungsi untuk menghapus habit
      function deleteHabit(id) {
        habitData.habits = habitData.habits.filter(h => h.id !== id);
        saveHabitData();
      }

      // Fungsi untuk toggle status penyelesaian kebiasaan
      function toggleHabitCompletion(habitId, dayIndex) {
        const h = habitData.habits.find(h => h.id === habitId);
        if (!h) return;
        h.days[dayIndex] = !h.days[dayIndex];
        h.completedDays = h.days.filter(Boolean).length;
        saveHabitData();
      }

      // Render utama
      function renderAll() {
        renderHabitList();
        updateStats();
        updateWeeklyChart();
        updatePieChart();
      }

      // Fungsi untuk render daftar kebiasaan dengan checkbox harian
      function renderHabitList() {
        const container = document.getElementById('habit-list-container');
        if (!container) return;

        container.innerHTML = '';

        if (!habitData.habits || habitData.habits.length === 0) {
          container.innerHTML = `
      <div class="text-center py-8 text-gray-500 dark:text-gray-400">
        Belum ada kebiasaan. Klik tombol "Tambah" untuk mulai mencatat kebiasaan Anda.
      </div>
    `;
          return;
        }

        habitData.habits.forEach(habit => {
          const h = normalizeHabit(habit);
          const el = document.createElement('div');
          el.className = 'bg-gray-50 dark:bg-gray-800 rounded-lg p-4 flex flex-col gap-4 mb-3';
          el.innerHTML = `
            <div class='flex items-center justify-between'>
              <div class='flex items-center gap-3 flex-1'>
                <div>
                  <h4 class='font-medium text-gray-900 dark:text-white'>${h.name}</h4>
                  <p class='text-sm text-gray-500 dark:text-gray-400'>${h.completedDays}/${h.targetDays} hari</p>
                </div>
              </div>
              <div class='flex items-center gap-4'>
                <div class='w-32 bg-gray-200 dark:bg-gray-700 rounded-full h-2'>
                  <div class='${h.color} h-2 rounded-full transition-all duration-300' style='width: ${(h.completedDays / h.targetDays) * 100}%'></div>
                </div>
                <button onclick='showEditHabit(${h.id})' aria-label='Edit kebiasaan' class='p-2 rounded hover:bg-blue-100 dark:hover:bg-blue-900 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mr-2 focus:outline-none focus:ring-2 focus:ring-blue-400'>
                  <svg xmlns='http://www.w3.org/2000/svg' class='w-5 h-5' fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'><path stroke-linecap='round' stroke-linejoin='round' d='M12 20h9'/><path stroke-linecap='round' stroke-linejoin='round' d='M16.5 3.5a2.121 2.121 0 113 3L7 19.5 3 21l1.5-4L16.5 3.5z'/></svg>
                </button>
                <button onclick='showDeleteConfirmation(${h.id})' aria-label='Hapus kebiasaan' class='p-2 rounded hover:bg-red-100 dark:hover:bg-red-900 text-red-600 hover:text-red-700 dark:text-red-500 dark:hover:text-red-400 focus:outline-none focus:ring-2 focus:ring-red-400'>
                  <svg xmlns='http://www.w3.org/2000/svg' class='w-5 h-5' fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'><polyline points='3 6 5 6 21 6'/><path d='M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2'/><line x1='10' y1='11' x2='10' y2='17'/><line x1='14' y1='11' x2='14' y2='17'/></svg>
                </button>
              </div>
            </div>
            <div class='flex flex-row flex-wrap gap-10'>
              ${h.selectedDays.map((dayIdx, i) => `
                <div class='flex flex-col items-center'>
                  <div class='w-8 h-8 flex items-center justify-center rounded-lg cursor-pointer ${h.days[i] ? h.color + ' text-white' : 'bg-gray-100 dark:bg-gray-700'} hover:opacity-80 transition-all duration-200' onclick='toggleHabitCompletion(${h.id},${i})'>
                    ${h.days[i] ? `<svg class='w-5 h-5' fill='none' stroke='currentColor' viewBox='0 0 24 24'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 13l4 4L19 7'></path></svg>` : ''}
                  </div>
                  <span class='text-xs text-gray-500 dark:text-white mt-1'>${daysOfWeek[dayIdx]}</span>
                </div>
              `).join('')}
            </div>
          `;
          container.appendChild(el);
        });

        // Update diagrams after rendering
        updateStats();
        updateWeeklyChart();
        updatePieChart();
      }

    </script>

    <!-- Modal Tambah Kebiasaan -->
    <div
      id="tambah-kebiasaan-modal"
      class="fixed inset-0 z-50 hidden"
      aria-hidden="true"
    >
      <div
        class="fixed inset-0 bg-white/30 dark:bg-gray-900/30 backdrop-blur-sm backdrop-saturate-150 backdrop-brightness-110 transition-opacity"
        id="modal-backdrop"
      ></div>
      <div class="fixed inset-0 z-10 overflow-y-auto">
        <div class="flex min-h-screen items-center justify-center p-4 text-center sm:items-center sm:p-0">
          <div class="relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900 dark:text-white">Tambah Kebiasaan Baru</h3>
              <button
                id="close-modal"
                type="button"
                class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-700 dark:hover:text-white"
              >
                <svg
                  class="w-5 h-5"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
              </button>
            </div>
            <form id="tambah-kebiasaan-form">
              <div class="mb-4">
                <label
                  for="habit-name"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                  >Nama Kebiasaan</label
                >
                <input
                  type="text"
                  id="habit-name"
                  class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary focus:border-primary block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                  placeholder="Contoh: Berolahraga"
                  required
                />
              </div>   
              <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Pilih Hari</label>
                <div class="flex gap-2">
                  <label aria-label="Senin" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="0" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Sen</span>
                  </label>
                  <label aria-label="Selasa" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="1" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Sel</span>
                  </label>
                  <label aria-label="Rabu" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="2" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Rab</span>
                  </label>
                  <label aria-label="Kamis" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="3" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Kam</span>
                  </label>
                  <label aria-label="Jumat" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="4" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Jum</span>
                  </label>
                  <label aria-label="Sabtu" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="5" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Sab</span>
                  </label>
                  <label aria-label="Minggu" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="6" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Min</span>
                  </label>
                </div>
              </div>
              <div class="mb-4">
                <label
                  for="habit-color"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                  >Warna</label
                >
                <div class="flex space-x-2">
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-primary"
                      class="sr-only"
                      checked
                    />
                    <div class="w-6 h-6 bg-primary rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-secondary"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-secondary rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-accent"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-accent rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-purple-500"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-purple-500 rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-green-500"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-green-500 rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                </div>
              </div>
              <div class="flex flex-col mb-4 w-64">  
                <label for="habit-reminder" class="block text-white text-sm font-bold mb-2">Waktu Pengingat:</label>  
                <input type="text" id="habit-reminder" class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline">  
              </div>  
              
              
              <button
                type="submit"
                class="w-full text-white bg-primary hover:bg-blue-600 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary dark:hover:bg-blue-600 dark:focus:ring-blue-800"
              >
                Tambah Kebiasaan
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Konfirmasi Hapus -->
    <div
      id="konfirmasi-hapus-modal"
      class="fixed inset-0 z-50 opacity-0 pointer-events-none"
    >
      <div
        class="absolute inset-0 backdrop-blur-xl bg-white/30 dark:bg-gray-900/30 backdrop-saturate-150 backdrop-brightness-110"
        id="konfirmasi-backdrop"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md relative z-10">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white">Konfirmasi Penghapusan</h3>
            <button
              id="close-konfirmasi"
              class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-700 dark:hover:text-white"
            >
              <svg
                class="w-5 h-5"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </button>
          </div>
          <p class="text-gray-700 dark:text-gray-300 mb-6">Apakah Anda yakin ingin menghapus kebiasaan ini?</p>
          <div class="flex justify-end space-x-3">
            <button
              id="batal-hapus"
              class="px-4 py-2 text-sm font-medium text-gray-500 bg-gray-100 rounded-lg border border-gray-200 hover:bg-gray-200 focus:z-10 focus:ring-2 focus:ring-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:bg-gray-600"
            >
              Batal
            </button>
            <button
              id="konfirmasi-hapus"
              class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:z-10 focus:ring-2 focus:ring-red-300 dark:bg-red-500 dark:hover:bg-red-600"
            >
              Hapus
            </button>
          </div>
        </div>
      </div>
    </div>

   
  <!-- Tambahkan di akhir <body> sebelum </html> -->
<div id="habit-reminder-modal" class="fixed inset-0 z-50 hidden bg-black/40 flex items-center justify-center">
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-xs w-full text-center">
    <h3 class="text-lg font-semibold mb-2 text-gray-900 dark:text-white">Pengingat Kebiasaan</h3>
    <p id="habit-reminder-modal-text" class="mb-4 text-gray-700 dark:text-gray-300"></p>
    <button id="habit-reminder-modal-close" class="mt-2 px-4 py-2 bg-primary text-white rounded hover:bg-blue-600">Tutup</button>
  </div>
</div>




    <!-- Stats and Charts JS -->
    <script>
      // Fungsi untuk memperbarui statistik
      function updateStats() {
        const totalHabits = habitData.habits.length;
        let totalCompleted = 0, totalTarget = 0;
        habitData.habits.forEach(h => {
          totalCompleted += h.completedDays;
          totalTarget += h.targetDays;
        });
        const percent = totalTarget > 0 ? Math.round((totalCompleted / totalTarget) * 100) : 0;
        const pieChartPath = document.querySelector('svg path.text-primary');
        if (pieChartPath) pieChartPath.setAttribute('stroke-dasharray', `${percent}, 100`);
        const completionText = document.querySelector('svg text');
        if (completionText) completionText.textContent = `${percent}%`;
      }

      // Fungsi untuk memperbarui diagram batang mingguan
      function updateWeeklyChart() {
        const chartContainer = document.getElementById('chart-bars');
        if (!chartContainer) return;
        chartContainer.innerHTML = '';
        const dailyProgress = Array(7).fill(0), dailyTargets = Array(7).fill(0);
        habitData.habits.forEach(h => {
          h.selectedDays.forEach((d, i) => {
            dailyTargets[d]++;
            if (h.days[i]) dailyProgress[d]++;
          });
        });
        const barsContainer = document.createElement('div');
        barsContainer.className = 'flex justify-between items-end w-full h-full gap-x-1 sm:gap-x-2';
        for (let i = 0; i < 7; i++) {
          const progress = dailyTargets[i] > 0 ? Math.round((dailyProgress[i] / dailyTargets[i]) * 100) : 0;
          const barContainer = document.createElement('div');
          barContainer.className = 'flex flex-col items-center relative h-full';
          barContainer.style.width = '12%';
          const barsWrapper = document.createElement('div');
          barsWrapper.className = 'relative w-5 h-full';
          const targetBar = document.createElement('div');
          targetBar.className = 'absolute inset-0 border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 bg-opacity-30 rounded-t-md';
          const progressBar = document.createElement('div');
          progressBar.className = 'absolute bottom-0 inset-x-0 bg-primary rounded-t-md transition-all duration-300';
          progressBar.style.height = `${progress}%`;
          const percentLabel = document.createElement('div');
          percentLabel.className = 'absolute -top-6 text-xs font-medium text-gray-600 dark:text-gray-300';
          percentLabel.textContent = `${progress}%`;
          const dayLabel = document.createElement('div');
          dayLabel.className = 'absolute -bottom-6 text-xs text-gray-600 dark:text-gray-400';
          dayLabel.textContent = daysOfWeek[i];
          barsWrapper.appendChild(targetBar);
          barsWrapper.appendChild(progressBar);
          barContainer.appendChild(percentLabel);
          barContainer.appendChild(barsWrapper);
          barContainer.appendChild(dayLabel);
          barsContainer.appendChild(barContainer);
        }
        chartContainer.appendChild(barsContainer);
      }
      // Fungsi untuk memperbarui pie chart
      function updatePieChart() {
        let totalCompleted = 0, totalTarget = 0;
        habitData.habits.forEach(h => {
          totalCompleted += h.completedDays;
          totalTarget += h.targetDays;
        });
        const percent = totalTarget > 0 ? Math.round((totalCompleted / totalTarget) * 100) : 0;
        const weeklyFocus = document.querySelector('.text-2xl.font-bold');
        if (weeklyFocus) weeklyFocus.textContent = `${((totalCompleted * 24) / 7).toFixed(1)} jam`;
        const progressBar = document.querySelector('.bg-primary.h-4');
        if (progressBar) progressBar.style.width = `${percent}%`;
      }

      // Modal utilitas
      function showDeleteConfirmation(id) {
        habitIdToDelete = id;
        document.getElementById('konfirmasi-hapus-modal').classList.remove('opacity-0', 'pointer-events-none');
      }
      document.getElementById('konfirmasi-hapus').onclick = function() {
        if (habitIdToDelete !== null) {
          deleteHabit(habitIdToDelete);
          habitIdToDelete = null;
        }
        document.getElementById('konfirmasi-hapus-modal').classList.add('opacity-0', 'pointer-events-none');
      };
      document.getElementById('batal-hapus').onclick =
      document.getElementById('close-konfirmasi').onclick = function() {
        habitIdToDelete = null;
        document.getElementById('konfirmasi-hapus-modal').classList.add('opacity-0', 'pointer-events-none');
      };

      function showEditHabit(id) {
        habitIdToEdit = id;
        const h = habitData.habits.find(h => h.id === id);
        if (!h) return;
        document.getElementById('habit-name').value = h.name;
        document.getElementById('habit-reminder').value = h.reminderTime || '';
        const colorInputs = document.querySelectorAll('input[name="habit-color"]');
        colorInputs.forEach(input => { input.checked = input.value === h.color; });
        const dayCheckboxes = document.querySelectorAll('input[name="habit-days"]');
        dayCheckboxes.forEach(cb => { cb.checked = h.selectedDays.includes(parseInt(cb.value)); });
        document.getElementById('tambah-kebiasaan-modal').classList.remove('hidden');
      }

    </script>

    <!-- Modal Tambah Kebiasaan -->
    <div
      id="tambah-kebiasaan-modal"
      class="fixed inset-0 z-50 hidden"
      aria-hidden="true"
    >
      <div
        class="fixed inset-0 bg-white/30 dark:bg-gray-900/30 backdrop-blur-sm backdrop-saturate-150 backdrop-brightness-110 transition-opacity"
        id="modal-backdrop"
      ></div>
      <div class="fixed inset-0 z-10 overflow-y-auto">
        <div class="flex min-h-screen items-center justify-center p-4 text-center sm:items-center sm:p-0">
          <div class="relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900 dark:text-white">Tambah Kebiasaan Baru</h3>
              <button
                id="close-modal"
                type="button"
                class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-700 dark:hover:text-white"
              >
                <svg
                  class="w-5 h-5"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                    clip-rule="evenodd"
                  ></path>
                </svg>
              </button>
            </div>
            <form id="tambah-kebiasaan-form">
              <div class="mb-4">
                <label
                  for="habit-name"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                  >Nama Kebiasaan</label
                >
                <input
                  type="text"
                  id="habit-name"
                  class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary focus:border-primary block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                  placeholder="Contoh: Berolahraga"
                  required
                />
              </div>   
              <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Pilih Hari</label>
                <div class="flex gap-2">
                  <label aria-label="Senin" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="0" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Sen</span>
                  </label>
                  <label aria-label="Selasa" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="1" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Sel</span>
                  </label>
                  <label aria-label="Rabu" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="2" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Rab</span>
                  </label>
                  <label aria-label="Kamis" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="3" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Kam</span>
                  </label>
                  <label aria-label="Jumat" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="4" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Jum</span>
                  </label>
                  <label aria-label="Sabtu" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="5" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Sab</span>
                  </label>
                  <label aria-label="Minggu" class="cursor-pointer">
                    <input type="checkbox" name="habit-days" value="6" class="sr-only peer pointer-events-auto" />
                    <span class="flex items-center justify-center w-10 h-10 rounded-full border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-white font-semibold peer-checked:bg-primary peer-checked:text-white peer-checked:border-primary transition-all duration-200 select-none">Min</span>
                  </label>
                </div>
              </div>
              <div class="mb-4">
                <label
                  for="habit-color"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                  >Warna</label
                >
                <div class="flex space-x-2">
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-primary"
                      class="sr-only"
                      checked
                    />
                    <div class="w-6 h-6 bg-primary rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-secondary"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-secondary rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-accent"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-accent rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-purple-500"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-purple-500 rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      name="habit-color"
                      value="bg-green-500"
                      class="sr-only"
                    />
                    <div class="w-6 h-6 bg-green-500 rounded-full border-2 border-transparent hover:border-gray-300"></div>
                  </label>
                </div>
              </div>
              <div class="flex flex-col mb-4 w-64">  
                <label for="habit-reminder" class="block text-white text-sm font-bold mb-2">Waktu Pengingat:</label>  
                <input type="text" id="habit-reminder" class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline">  
              </div>  
              
              
              <button
                type="submit"
                class="w-full text-white bg-primary hover:bg-blue-600 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary dark:hover:bg-blue-600 dark:focus:ring-blue-800"
              >
                Tambah Kebiasaan
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Konfirmasi Hapus -->
    <div
      id="konfirmasi-hapus-modal"
      class="fixed inset-0 z-50 opacity-0 pointer-events-none"
    >
      <div
        class="absolute inset-0 backdrop-blur-xl bg-white/30 dark:bg-gray-900/30 backdrop-saturate-150 backdrop-brightness-110"
        id="konfirmasi-backdrop"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md relative z-10">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white">Konfirmasi Penghapusan</h3>
            <button
              id="close-konfirmasi"
              class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-700 dark:hover:text-white"
            >
              <svg
                class="w-5 h-5"
                fill="currentColor"
                viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </button>
          </div>
          <p class="text-gray-700 dark:text-gray-300 mb-6">Apakah Anda yakin ingin menghapus kebiasaan ini?</p>
          <div class="flex justify-end space-x-3">
            <button
              id="batal-hapus"
              class="px-4 py-2 text-sm font-medium text-gray-500 bg-gray-100 rounded-lg border border-gray-200 hover:bg-gray-200 focus:z-10 focus:ring-2 focus:ring-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:bg-gray-600"
            >
              Batal
            </button>
            <button
              id="konfirmasi-hapus"
              class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:z-10 focus:ring-2 focus:ring-red-300 dark:bg-red-500 dark:hover:bg-red-600"
            >
              Hapus
            </button>
          </div>
        </div>
      </div>
    </div>

   
  <!-- Tambahkan di akhir <body> sebelum </html> -->
<div id="habit-reminder-modal" class="fixed inset-0 z-50 hidden bg-black/40 flex items-center justify-center">
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-xs w-full text-center">
    <h3 class="text-lg font-semibold mb-2 text-gray-900 dark:text-white">Pengingat Kebiasaan</h3>
    <p id="habit-reminder-modal-text" class="mb-4 text-gray-700 dark:text-gray-300"></p>
    <button id="habit-reminder-modal-close" class="mt-2 px-4 py-2 bg-primary text-white rounded hover:bg-blue-600">Tutup</button>
  </div>
</div>




    <!-- Stats and Charts JS -->
    <script>
      // Fungsi untuk memperbarui statistik
      function updateStats() {
        const totalHabits = habitData.habits.length;
        let totalCompleted = 0, totalTarget = 0;
        habitData.habits.forEach(h => {
          totalCompleted += h.completedDays;
          totalTarget += h.targetDays;
        });
        const percent = totalTarget > 0 ? Math.round((totalCompleted / totalTarget) * 100) : 0;
        const pieChartPath = document.querySelector('svg path.text-primary');
        if (pieChartPath) pieChartPath.setAttribute('stroke-dasharray', `${percent}, 100`);
        const completionText = document.querySelector('svg text');
        if (completionText) completionText.textContent = `${percent}%`;
      }

      // Fungsi untuk memperbarui diagram batang mingguan
      function updateWeeklyChart() {
        const chartContainer = document.getElementById('chart-bars');
        if (!chartContainer) return;
        chartContainer.innerHTML = '';
        const dailyProgress = Array(7).fill(0), dailyTargets = Array(7).fill(0);
        habitData.habits.forEach(h => {
          h.selectedDays.forEach((d, i) => {
            dailyTargets[d]++;
            if (h.days[i]) dailyProgress[d]++;
          });
        });
        const barsContainer = document.createElement('div');
        barsContainer.className = 'flex justify-between items-end w-full h-full gap-x-1 sm:gap-x-2';
        for (let i = 0; i < 7; i++) {
          const progress = dailyTargets[i] > 0 ? Math.round((dailyProgress[i] / dailyTargets[i]) * 100) : 0;
          const barContainer = document.createElement('div');
          barContainer.className = 'flex flex-col items-center relative h-full';
          barContainer.style.width = '12%';
          const barsWrapper = document.createElement('div');
          barsWrapper.className = 'relative w-5 h-full';
          const targetBar = document.createElement('div');
          targetBar.className = 'absolute inset-0 border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 bg-opacity-30 rounded-t-md';
          const progressBar = document.createElement('div');
          progressBar.className = 'absolute bottom-0 inset-x-0 bg-primary rounded-t-md transition-all duration-300';
          progressBar.style.height = `${progress}%`;
          const percentLabel = document.createElement('div');
          percentLabel.className = 'absolute -top-6 text-xs font-medium text-gray-600 dark:text-gray-300';
          percentLabel.textContent = `${progress}%`;
          const dayLabel = document.createElement('div');
          dayLabel.className = 'absolute -bottom-6 text-xs text-gray-600 dark:text-gray-400';
          dayLabel.textContent = daysOfWeek[i];
          barsWrapper.appendChild(targetBar);
          barsWrapper.appendChild(progressBar);
          barContainer.appendChild(percentLabel);
          barContainer.appendChild(barsWrapper);
          barContainer.appendChild(dayLabel);
          barsContainer.appendChild(barContainer);
        }
        chartContainer.appendChild(barsContainer);
      }
      // Fungsi untuk memperbarui pie chart
      function updatePieChart() {
        let totalCompleted = 0, totalTarget = 0;
        habitData.habits.forEach(h => {
          totalCompleted += h.completedDays;
          totalTarget += h.targetDays;
        });
        const percent = totalTarget > 0 ? Math.round((totalCompleted / totalTarget) * 100) : 0;
        const weeklyFocus = document.querySelector('.text-2xl.font-bold');
        if (weeklyFocus) weeklyFocus.textContent = `${((totalCompleted * 24) / 7).toFixed(1)} jam`;
        const progressBar = document.querySelector('.bg-primary.h-4');
        if (progressBar) progressBar.style.width = `${percent}%`;
      }

      // Modal utilitas
      function showDeleteConfirmation(id) {
        habitIdToDelete = id;
        document.getElementById('konfirmasi-hapus-modal').classList.remove('opacity-0', 'pointer-events-none');
      }
      document.getElementById('konfirmasi-hapus').onclick = function() {
        if (habitIdToDelete !== null) {
          deleteHabit(habitIdToDelete);
          habitIdToDelete = null;
        }
        document.getElementById('konfirmasi-hapus-modal').classList.add('opacity-0', 'pointer-events-none');
      };
      document.getElementById('batal-hapus').onclick =
      document.getElementById('close-konfirmasi').onclick = function() {
        habitIdToDelete = null;
        document.getElementById('konfirmasi-hapus-modal').classList.add('opacity-0', 'pointer-events-none');
      };

      function showEditHabit(id) {
        habitIdToEdit = id;
        const h = habitData.habits.find(h => h.id === id);
        if (!h) return;
        document.getElementById('habit-name').value = h.name;
        document.getElementById('habit-reminder').value = h.reminderTime || '';
        const colorInputs = document.querySelectorAll('input[name="habit-color"]');
        colorInputs.forEach(input => { input.checked = input.value === h.color; });
        const dayCheckboxes = document.querySelectorAll('input[name="habit-days"]');
        dayCheckboxes.forEach(cb => { cb.checked = h.selectedDays.includes(parseInt(cb.value)); });
        document.getElementById('tambah-kebiasaan-modal').classList.remove('hidden');
      }

    </script>

    <!-- Core JS -->
    <script>
      // Sumber data utama
let habitData = { habits: [] };
let habitIdToDelete = null;
let habitIdToEdit = null;
const DEFAULT_DAYS = [0, 1, 2, 3, 4, 5, 6];
const daysOfWeek = ['Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab', 'Min'];
const tambahKebiasaanForm = document.getElementById('tambah-kebiasaan-form');

// Utilitas: normalisasi habit agar selalu valid
function normalizeHabit(habit) {
  if (!habit.selectedDays) habit.selectedDays = [...DEFAULT_DAYS];
  if (!habit.days || habit.days.length !== habit.selectedDays.length) habit.days = Array(habit.selectedDays.length).fill(false);
  if (!habit.targetDays) habit.targetDays = habit.selectedDays.length;
  if (!habit.completedDays) habit.completedDays = habit.days.filter(Boolean).length;
  return habit;
}

// CRUD utama
function saveHabitData() {
  localStorage.setItem('habitData', JSON.stringify(habitData));
  renderAll();
}
function loadHabitData() {
  const saved = localStorage.getItem('habitData');
  habitData = saved ? JSON.parse(saved) : { habits: [] };
  habitData.habits = habitData.habits.map(normalizeHabit);
}
function createHabit(name, color, selectedDays, reminderTime) {
  habitData.habits.push(normalizeHabit({
    id: Date.now(),
    name,
    color,
    selectedDays,
    days: Array(selectedDays.length).fill(false),
    targetDays: selectedDays.length,
    completedDays: 0,
    reminderTime: reminderTime || '',
  }));
  saveHabitData();
}
function updateHabit(id, { name, color, selectedDays, reminderTime }) {
  const h = habitData.habits.find(h => h.id === id);
  if (!h) return;
  h.name = name;
  h.color = color;
  h.selectedDays = selectedDays;
  h.targetDays = selectedDays.length;
  h.reminderTime = reminderTime;
  if (!h.days || h.days.length !== selectedDays.length) {
    h.days = Array(selectedDays.length).fill(false);
    h.completedDays = 0;
  }
  saveHabitData();
}
function deleteHabit(id) {
  habitData.habits = habitData.habits.filter(h => h.id !== id);
  saveHabitData();
}
function toggleHabitCompletion(habitId, dayIndex) {
  const h = habitData.habits.find(h => h.id === habitId);
  if (!h) return;
  h.days[dayIndex] = !h.days[dayIndex];
  h.completedDays = h.days.filter(Boolean).length;
  saveHabitData();
}

// Render utama
function renderAll() {
  renderHabitList();
  updateStats();
  updateWeeklyChart();
  updatePieChart();
}

function renderHabitList() {
  const container = document.getElementById('habit-list-container');
  if (!container) return;

  container.innerHTML = '';

  if (!habitData.habits || habitData.habits.length === 0) {
    container.innerHTML = `
  <div class="text-center py-8 text-gray-500 dark:text-gray-400">
    Belum ada kebiasaan. Klik tombol "Tambah" untuk mulai mencatat kebiasaan Anda.
  </div>
`;
    return;
  }

  habitData.habits.forEach(habit => {
    const h = normalizeHabit(habit);
    const el = document.createElement('div');
    el.className = 'bg-gray-50 dark:bg-gray-800 rounded-lg p-4 flex flex-col gap-4 mb-3';
    el.innerHTML = `
      <div class='flex items-center justify-between'>
        <div class='flex items-center gap-3 flex-1'>
          <div>
            <h4 class='font-medium text-gray-900 dark:text-white'>${h.name}</h4>
            <p class='text-sm text-gray-500 dark:text-gray-400'>${h.completedDays}/${h.targetDays} hari</p>
          </div>
        </div>
        <div class='flex items-center gap-4'>
          <div class='w-32 bg-gray-200 dark:bg-gray-700 rounded-full h-2'>
            <div class='${h.color} h-2 rounded-full transition-all duration-300' style='width: ${(h.completedDays / h.targetDays) * 100}%'></div>
          </div>
          <button onclick='showEditHabit(${h.id})' aria-label='Edit kebiasaan' class='p-2 rounded hover:bg-blue-100 dark:hover:bg-blue-900 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mr-2 focus:outline-none focus:ring-2 focus:ring-blue-400'>
            <svg xmlns='http://www.w3.org/2000/svg' class='w-5 h-5' fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'><path stroke-linecap='round' stroke-linejoin='round' d='M12 20h9'/><path stroke-linecap='round' stroke-linejoin='round' d='M16.5 3.5a2.121 2.121 0 113 3L7 19.5 3 21l1.5-4L16.5 3.5z'/></svg>
          </button>
          <button onclick='showDeleteConfirmation(${h.id})' aria-label='Hapus kebiasaan' class='p-2 rounded hover:bg-red-100 dark:hover:bg-red-900 text-red-600 hover:text-red-700 dark:text-red-500 dark:hover:text-red-400 focus:outline-none focus:ring-2 focus:ring-red-400'>
            <svg xmlns='http://www.w3.org/2000/svg' class='w-5 h-5' fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'><polyline points='3 6 5 6 21 6'/><path d='M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2'/><line x1='10' y1='11' x2='10' y2='17'/><line x1='14' y1='11' x2='14' y2='17'/></svg>
          </button>
        </div>
      </div>
      <div class='flex flex-row flex-wrap gap-10'>
        ${h.selectedDays.map((dayIdx, i) => `
          <div class='flex flex-col items-center'>
            <div class='w-8 h-8 flex items-center justify-center rounded-lg cursor-pointer ${h.days[i] ? h.color + ' text-white' : 'bg-gray-100 dark:bg-gray-700'} hover:opacity-80 transition-all duration-200' onclick='toggleHabitCompletion(${h.id},${i})'>
              ${h.days[i] ? `<svg class='w-5 h-5' fill='none' stroke='currentColor' viewBox='0 0 24 24'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 13l4 4L19 7'></path></svg>` : ''}
            </div>
            <span class='text-xs text-gray-500 dark:text-white mt-1'>${daysOfWeek[dayIdx]}</span>
          </div>
        `).join('')}
      </div>
    `;
    container.appendChild(el);
  });

  // Update diagrams after rendering
  updateStats();
  updateWeeklyChart();
  updatePieChart();
}

// Chart & statistik
function updateStats() {
  const totalHabits = habitData.habits.length;
  let totalCompleted = 0, totalTarget = 0;
  habitData.habits.forEach(h => {
    totalCompleted += h.completedDays;
    totalTarget += h.targetDays;
  });
  const percent = totalTarget > 0 ? Math.round((totalCompleted / totalTarget) * 100) : 0;
  const pieChartPath = document.querySelector('svg path.text-primary');
  if (pieChartPath) pieChartPath.setAttribute('stroke-dasharray', `${percent}, 100`);
  const completionText = document.querySelector('svg text');
  if (completionText) completionText.textContent = `${percent}%`;
}
function updateWeeklyChart() {
  const chartContainer = document.getElementById('chart-bars');
  if (!chartContainer) return;
  chartContainer.innerHTML = '';
  const dailyProgress = Array(7).fill(0), dailyTargets = Array(7).fill(0);
  habitData.habits.forEach(h => {
    h.selectedDays.forEach((d, i) => {
      dailyTargets[d]++;
      if (h.days[i]) dailyProgress[d]++;
    });
  });
  const barsContainer = document.createElement('div');
  barsContainer.className = 'flex justify-between items-end w-full h-full gap-x-1 sm:gap-x-2';
  for (let i = 0; i < 7; i++) {
    const progress = dailyTargets[i] > 0 ? Math.round((dailyProgress[i] / dailyTargets[i]) * 100) : 0;
    const barContainer = document.createElement('div');
    barContainer.className = 'flex flex-col items-center relative h-full';
    barContainer.style.width = '12%';
    const barsWrapper = document.createElement('div');
    barsWrapper.className = 'relative w-5 h-full';
    const targetBar = document.createElement('div');
    targetBar.className = 'absolute inset-0 border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 bg-opacity-30 rounded-t-md';
    const progressBar = document.createElement('div');
    progressBar.className = 'absolute bottom-0 inset-x-0 bg-primary rounded-t-md transition-all duration-300';
    progressBar.style.height = `${progress}%`;
    const percentLabel = document.createElement('div');
    percentLabel.className = 'absolute -top-6 text-xs font-medium text-gray-600 dark:text-gray-300';
    percentLabel.textContent = `${progress}%`;
    const dayLabel = document.createElement('div');
    dayLabel.className = 'absolute -bottom-6 text-xs text-gray-600 dark:text-gray-400';
    dayLabel.textContent = daysOfWeek[i];
    barsWrapper.appendChild(targetBar);
    barsWrapper.appendChild(progressBar);
    barContainer.appendChild(percentLabel);
    barContainer.appendChild(barsWrapper);
    barContainer.appendChild(dayLabel);
    barsContainer.appendChild(barContainer);
  }
  chartContainer.appendChild(barsContainer);
}
function updatePieChart() {
  let totalCompleted = 0, totalTarget = 0;
  habitData.habits.forEach(h => {
    totalCompleted += h.completedDays;
    totalTarget += h.targetDays;
  });
  const percent = totalTarget > 0 ? Math.round((totalCompleted / totalTarget) * 100) : 0;
  const weeklyFocus = document.querySelector('.text-2xl.font-bold');
  if (weeklyFocus) weeklyFocus.textContent = `${((totalCompleted * 24) / 7).toFixed(1)} jam`;
  const progressBar = document.querySelector('.bg-primary.h-4');
  if (progressBar) progressBar.style.width = `${percent}%`;
}

// Modal utilitas
function showDeleteConfirmation(id) {
  habitIdToDelete = id;
  document.getElementById('konfirmasi-hapus-modal').classList.remove('opacity-0', 'pointer-events-none');
}
document.getElementById('konfirmasi-hapus').onclick = function() {
  if (habitIdToDelete !== null) {
    deleteHabit(habitIdToDelete);
    habitIdToDelete = null;
  }
  document.getElementById('konfirmasi-hapus-modal').classList.add('opacity-0', 'pointer-events-none');
};
document.getElementById('batal-hapus').onclick =
document.getElementById('close-konfirmasi').onclick = function() {
  habitIdToDelete = null;
  document.getElementById('konfirmasi-hapus-modal').classList.add('opacity-0', 'pointer-events-none');
};

function showEditHabit(id) {
  habitIdToEdit = id;
  const h = habitData.habits.find(h => h.id === id);
  if (!h) return;
  document.getElementById('habit-name').value = h.name;
  document.getElementById('habit-reminder').value = h.reminderTime || '';
  const colorInputs = document.querySelectorAll('input[name="habit-color"]');
  colorInputs.forEach(input => { input.checked = input.value === h.color; });
  const dayCheckboxes = document.querySelectorAll('input[name="habit-days"]');
  dayCheckboxes.forEach(cb => { cb.checked = h.selectedDays.includes(parseInt(cb.value)); });
  document.getElementById('tambah-kebiasaan-modal').classList.remove('hidden');
}

// Form tambah/edit habit
tambahKebiasaanForm?.addEventListener('submit', function (e) {
  e.preventDefault();
  const name = document.getElementById('habit-name').value;
  const colorInput = document.querySelector('input[name="habit-color"]:checked');
  const color = colorInput ? colorInput.value : 'bg-primary';
  const dayCheckboxes = document.querySelectorAll('input[name="habit-days"]:checked');
  const selectedDays = Array.from(dayCheckboxes).map(cb => parseInt(cb.value));
  if (selectedDays.length === 0) { alert('Pilih minimal satu hari!'); return; }
  const reminderTime = document.getElementById('habit-reminder').value;
  if (habitIdToEdit !== null) {
    updateHabit(habitIdToEdit, { name, color, selectedDays, reminderTime });
    habitIdToEdit = null;
  } else {
    createHabit(name, color, selectedDays, reminderTime);
  }
  document.getElementById('tambah-kebiasaan-modal').classList.add('hidden');
  this.reset();
});

// Modal tambah
const openModalBtn = document.getElementById('tambah-kebiasaan-btn');
const closeModalBtn = document.getElementById('close-modal');
const modalBackdrop = document.getElementById('modal-backdrop');
openModalBtn?.addEventListener('click', () => document.getElementById('tambah-kebiasaan-modal').classList.remove('hidden'));
closeModalBtn?.addEventListener('click', () => document.getElementById('tambah-kebiasaan-modal').classList.add('hidden'));
modalBackdrop?.addEventListener('click', () => document.getElementById('tambah-kebiasaan-modal').classList.add('hidden'));

// Inisialisasi
function initializeApp() {
  loadHabitData();
  renderAll();
}
document.addEventListener('DOMContentLoaded', initializeApp);
    </script>

    <script>
      // Initialize color picker behavior
      document.addEventListener('DOMContentLoaded', function () {
        const colorInputs = document.querySelectorAll('input[name="habit-color"]');
        const colorLabels = document.querySelectorAll('input[name="habit-color"] + div');

        colorInputs.forEach((input, index) => {
          input.addEventListener('change', function () {
            // Remove border from all labels
            colorLabels.forEach((label) => {
              label.classList.remove('border-gray-900', 'dark:border-white');
              label.classList.add('border-transparent');
            });

            // Add border to selected label
            if (this.checked) {
              colorLabels[index].classList.remove('border-transparent');
              colorLabels[index].classList.add('border-gray-900', 'dark:border-white');
            }
          });

          // Initialize selected state
          if (input.checked) {
            colorLabels[index].classList.remove('border-transparent');
            colorLabels[index].classList.add('border-gray-900', 'dark:border-white');
          }
        });
      });
    </script>



  
      

    <script>
        // Notifikasi & Pengingat Dasar
        if ('Notification' in window && Notification.permission !== 'granted') {
          Notification.requestPermission();
        } 

        document.getElementById('habit-reminder-modal-close').onclick = function() {
          const modal = document.getElementById('habit-reminder-modal');
          const habitId = modal.dataset.habitId;
          if (habitId) {
            const dismissed = getDismissedHabits();
            if (!dismissed.includes(Number(habitId))) {
              dismissed.push(Number(habitId));
              setDismissedHabits(dismissed);
            }
          }
          modal.classList.add('hidden');
          modal.dataset.habitId = '';
        };

        
  
        setInterval(() => {
          const now = new Date();
          habitData.habits?.forEach(habit => {
            if (!habit.reminderTime) return;
            const [h, m] = habit.reminderTime.split(':');
            if (parseInt(h) === now.getHours() && parseInt(m) === now.getMinutes()) {
              // Cek jika hari ini adalah hari habit
              const dayIdx = (now.getDay() === 0 ? 6 : now.getDay() - 1);
              if (habit.selectedDays?.includes(dayIdx) && !habit.days[habit.selectedDays.indexOf(dayIdx)]) {
                showHabitReminder(habit);
              }
            }
          });
        }, 5000);
    </script>

    <script>
      function getDismissedHabits() {
        return JSON.parse(localStorage.getItem('dismissedHabits') || '[]');
      }
      function setDismissedHabits(arr) {
        localStorage.setItem('dismissedHabits', JSON.stringify(arr));
      }
    </script>

    <script>
      function playNotificationSound() {
        const audio = new Audio('../public/notif.wav');
        audio.play();
      }

      function showHabitReminder(habit) {
        const dismissed = getDismissedHabits();
        if (dismissed.includes(habit.id)) return;

        playNotificationSound();

        if ('Notification' in window && Notification.permission === 'granted') {
          new Notification('Pengingat Kebiasaan', {
            body: `Saatnya melakukan: ${habit.name}`,
            icon: '/favicon.ico',
          });
        } else {
          const modal = document.getElementById('habit-reminder-modal');
          const modalText = document.getElementById('habit-reminder-modal-text');
          modalText.textContent = `Saatnya melakukan: ${habit.name}`;
          modal.classList.remove('hidden');
          modal.dataset.habitId = habit.id;
        }
      }
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        flatpickr("#habit-reminder", {
          enableTime: true,
          noCalendar: true,
          dateFormat: "H:i",
          time_24hr: true,
          minuteIncrement: 1,
          allowInput: true
        });
      });
    </script>
  </body>
</html>
